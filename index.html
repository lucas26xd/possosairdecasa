<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta name="author" content="Lucas Santos">
    <meta name="generator" content="VS Code">
    <meta name="description" content="Posso sair de casa?">
    <meta name="keywords" content="HTML, CSS, JS, Corona V√≠rus">
    <link rel="icon" type="image/x-icon" class="favicon" href="https://twemoji.maxcdn.com/2/svg/1f637.svg">
    <title>Posso sair de casa?</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
</head>
<body>
    <div title="Geolocaliza√ßao" id="geolocation" class="pl-3 bg-info text-white">
        <h5>üó∫ Autorize para pegar sua geolocaliza√ß√£o.</h5>
    </div>
    
    <div id="sair" class="m-2 shadow p-1 bg-white rounded text-center">
        <h1>Posso sair de casa?</h1>
        <h3>Hoje <span id="dia"></span>.</h3>
    </div>
    
    <div id="local" class="bg-info text-white rounded text-center">
    </div>
    
    <div title="Procurando casos pertos de voc√™..." id="loading" class="m-2 shadow p-2 bg-white rounded text-center">
        <h2 id="find">Procurando casos suspeitos pertos de voc√™...</h2>
        <img src="https://i.pinimg.com/originals/e4/38/e1/e438e1b7a4f6bb5a48cd5971f538571a.gif" alt="Carregando..." class=".img-fluid" style="max-width: 100%; height: auto;">
    </div>
    
    <div title="ü¶† Obviamente que n√£o!" id="nao" class="m-2 shadow p-2 bg-white rounded text-center">
        <h1><strong>Obviamente que N√ÉO!</strong></h1>    
        <img src="https://media1.giphy.com/media/3o752g7sZytAjxS71C/giphy.gif?cid=790b7611accd081758ec5cfe2a9040b796f4ddc0bf64f563&rid=giphy.gif" alt="N√ÉO!" class=".img-fluid" style="max-width: 100%; height: auto;">
        <p class="text-secondary">N√£o importa onde voc·∫Ω esteja, n√£o saia de casa sem necessidade.</p>
        <p class="text-secondary">Isso √© extremamente importante para que o v√≠rus n√£o se prolifere cada vez mais.</p>
        <hr>
        <div title="#FICAEMCASA" class="ml-5 mr-5">
            <p class="text-justify">#FICAEMCASA</p>
        </div>
    </div>
    
    <footer class="text-center text-secondary">Para mais informa√ß√µes sobre o Corona V√≠rus acesse <a title="corona" href="https://coronabr.com.br/">aqui</a>.</footer>
    
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    
    <script>
        $('#nao').hide()
        $('#loading').hide()
        
        setTimeout(() => {
            $('#find').text('Calculando necessidade de sair de casa...')
        }, 4000)
        
        $('#dia').text(new Date().toLocaleString())
        getLocation()
        function getLocation() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(showPosition, showError)
            } else {
                $('#geolocation').text('Seu navegador n√£o suporta geolocaliza√ß√£o.')
                removeGeo()
            }
        }
        
        function removeGeo() {
            $('#geolocation').removeClass('bg-info')
            $('#geolocation').addClass('bg-danger')
            setTimeout(() => {
                $('#geolocation').remove()
            }, 3000)
        }
        
        function showPosition(position) {
            $('#geolocation').addClass('d-none')
            $.getJSON(`https://nominatim.openstreetmap.org/reverse?lat=${position.coords.latitude}&lon=${position.coords.longitude}&format=json`, json => {
                $('#local').html(`<h3>Voc√™ est√° em <strong>${json["address"]["city"]} - ${json["address"]["state"]}</strong>.</h3>`)
                $('#loading').show()
                setTimeout(() => {
                    $('#nao').show(1000)
                    $('#loading').hide()
                }, 4000)
                
            })
        }
        
        function showError(error) {
            switch(error.code) {
                case error.PERMISSION_DENIED:
                $('#geolocation').text('Geolocaliza√ß√£o rejeitada.')
                removeGeo()
                break;
                case error.POSITION_UNAVAILABLE:
                $('#geolocation').text('Localiza√ß√£o n√£o dispon√≠vel.')
                removeGeo()
                break;
                case error.TIMEOUT:
                $('#geolocation').text('Tempo limite atingido.')
                removeGeo()
                break;
                case error.UNKNOWN_ERROR:
                $('#geolocation').text('Algo deu errado.')
                removeGeo()
                break;
            }
        }
    </script>
</body>
</html>