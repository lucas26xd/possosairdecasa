<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta name="author" content="Lucas Santos">
    <meta name="generator" content="VS Code">
    <meta name="description" content="Posso sair de casa?">
    <meta name="keywords" content="HTML, CSS, JS, Corona V√≠rus">
    <link rel="icon" type="image/x-icon" class="favicon" href="https://twemoji.maxcdn.com/2/svg/1f637.svg">
    <title>Posso sair de casa?</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
</head>
<body>
    <div title="Geolocation" id="geolocation" class="mt-5 pt-2 pl-3 bg-info text-white">
        <h5>üó∫ Autorize para pegar sua geolocaliza√ß√£o.</h5>
    </div>

    <div id="local" class="m-2 shadow p-3 bg-white rounded text-center">
    </div>

    <div title="ü¶†Obviamente que n√£o!" id="nao" class="m-2 shadow p-3 bg-white rounded text-center">
        <h1><strong>N√£o!</strong></h1>    
        <img id="gif" src="https://media1.giphy.com/media/3o752g7sZytAjxS71C/giphy.gif?cid=790b7611accd081758ec5cfe2a9040b796f4ddc0bf64f563&rid=giphy.gif" alt="N√ÉO!" style="max-width: 300px;">
        
        <p class="text-secondary">N√£o importa onde voc·∫Ω esteja, n√£o saia de casa sem necessidade.</p>
        <hr>
        <div title="#FICAEMCASA" class="ml-5 mr-5">
            <p class="text-justify">#FICAEMCASA</p>
        </div>
    </div>
    
    <script>
        getLocation()
        function getLocation() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(showPosition, showError)
            } else {
                $('#geolocation').text('Seu navegador n√£o suporta geolocaliza√ß√£o.')
                removeGeo()
            }
        }
        
        function removeGeo() {
            $('#geolocation').removeClass('bg-info')
            $('#geolocation').addClass('bg-danger')
            setTimeout(() => {
                $('#geolocation').remove()
            }, 3000)
        }
        
        function showPosition(position) {
            $('#geolocation').addClass('d-none')
            $('#profile').addClass('mt-5')
            $.ajax(`http://maps.googleapis.com/maps/api/geocode/json?latlng=${position.coords.latitude},${position.coords.longitude}`, {dataType: 'json'}).done(json => {
                $('#local').html(json)
                // $(xml).find('cidade')
                // const cid = xml.find('nome').text()
                // const uf = xml.find('uf').text()
                // $('#local').html(`Voc√™ est√° em ${cid} - ${uf}`)
                // $('#geolocation').removeClass('d-none')
            })
        }
            
            function showError(error) {
                switch(error.code) {
                    case error.PERMISSION_DENIED:
                    $('#geolocation').text('Geolocaliza√ß√£o rejeitada.')
                    removeGeo()
                    break;
                    case error.POSITION_UNAVAILABLE:
                    $('#geolocation').text('Localiza√ß√£o n√£o dispon√≠vel.')
                    removeGeo()
                    break;
                    case error.TIMEOUT:
                    $('#geolocation').text('Tempo limite atingido.')
                    removeGeo()
                    break;
                    case error.UNKNOWN_ERROR:
                    $('#geolocation').text('Algo deu errado.')
                    removeGeo()
                    break;
                }
            }
        </script>
    </body>
    </html>